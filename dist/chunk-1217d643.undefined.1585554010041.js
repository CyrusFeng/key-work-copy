(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1217d643"],{"3d2c":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"}},[a("div",{ref:"wrapper",staticClass:"scroll-wrap",staticStyle:{height:"calc(100% - 0.45rem)",overflow:"hidden"}},[a("div",[a("div",{staticClass:"block"},[a("div",{staticClass:"title-wrap"},[a("field-title",{attrs:{"blueline-visible":!1,"redstar-visible":!1}},[e._v("过程反馈")])],1),a("div",{staticClass:"text"},[a("c-textarea",{attrs:{"default-value":"",remark:"",tips:"请描述本阶段重点工作进展情况"},on:{"update:inputValue":function(t){e.des=t}}})],1)]),3===e.$store.getters.currentRole?a("div",{staticClass:"block approver"},[a("div",{staticClass:"title-wrap"},[a("div",[a("field-title",{attrs:{"blueline-visible":!1,"redstar-visible":!1}},[e._v("责任人审批")])],1),a("i",{staticClass:"icon",on:{click:e.onClickToChooseApprover}})]),a("div",{staticClass:"des-wrap"},[a("div",{staticClass:"wrap"},[a("div",{staticClass:"left"},[e.approverAvatarUrl?a("img",{attrs:{src:e.approverAvatarUrl}}):e._e()]),a("div",{staticClass:"right"},[a("span",[e._v(e._s(e.approverName))])])])])]):e._e()])]),a("div",{staticClass:"button-wrap"},[a("div",{staticClass:"btn2",on:{click:e.onClickToSave}},[a("span",[e._v("发送")])])]),a("image-panel",{attrs:{url:e.imageUrl,showImagePanel:e.showImagePanel},on:{"update:showImagePanel":function(t){e.showImagePanel=t},"update:show-image-panel":function(t){e.showImagePanel=t}}}),a("FullPageLoading",{attrs:{loading:e.loading}}),a("FullPageLoading",{attrs:{loading:e.loading1}}),a("StatePage",{attrs:{success:e.success,tipVisible:e.tipVisible,tipFailedDesc:e.tipFailedDesc,"jump-to":e.path},on:{"update:tipVisible":function(t){e.tipVisible=t}}}),a("Validator",{attrs:{source:e.source,validatorVisible:e.validatorVisible},on:{"update:validatorVisible":function(t){e.validatorVisible=t}}})],1)},s=[],r=a("bd86"),o=(a("ac6a"),a("7f7f"),a("bc3a")),l=a.n(o),n=a("4328"),c=a.n(n),p={name:"feedback",data:function(){return{isAgree:2,des:"",options:[{label:"同意",value:2},{label:"不同意",value:3}],imageUrl:"",showImagePanel:!1,loading:!1,loading1:!1,urlObj:[],approverName:"",approverAvatarUrl:"",approverID:"",scroll:null,tipVisible:!1,success:!1,source:{},validatorVisible:!1,taskLifeList:[],path:"",tipFailedDesc:"",chargerID:"",chargerName:"",chargerAvatarUrl:""}},beforeRouteEnter:function(e,t,a){qing.call("setWebViewTitle",{title:"过程反馈"}),a(function(e){if("taskdetail"===t.name){var a=e.$route.params.detailObj;e.detailObj=a,e.detailObj&&localStorage.setItem("detailObj",JSON.stringify(e.detailObj))}else e.detailObj=JSON.parse(localStorage.getItem("detailObj"));console.log("vm.detailObj.taskLifeList",e.detailObj.taskLifeList),e.urlObj=[],e.detailObj.chargerID&&(e.loading1=!0,e.$getPersonInfoByOpenID(e.detailObj.chargerID).then(function(t){var a=t.data.result.data[0];e.approverID=a.openId,e.approverName=a.name,e.approverAvatarUrl=a.photoUrl,e.loading1=!1}).catch(function(e){alert("获取责任人信息失败")})),console.log("vm.detailObj",e.detailObj)})},mounted:function(){this.$initScroll(this.scroll,this.$refs.wrapper)},methods:Object(r["a"])({onClickToChooseImage:function(){var e=this;qing.call("chooseImage",{type:"camera",needCut:!1,isMulti:!0,maxSelectCount:9,showOrigin:!1,success:function(t){t.data.localIds.forEach(function(t){qing.call("uploadImage",{localId:t,isShowProgressTips:1,success:function(t){if("true"===t.success||!0===t.success){var a=t.data.serverId;e.urlObj.push({url:"https://yunzhijia.com//openfile/download/media/".concat(a),showLoading:!0})}else alert("图片上传失败，请重试")}})})}})},onClickToChooseApprover:function(){var e=this;qing.call("selectPersons",{isMulti:!1,success:function(t){e.approverAvatarUrl=t.data.persons[0].avatarUrl,e.approverName=t.data.persons[0].name,e.approverID=t.data.persons[0].openId}})},onClickImage:function(e){this.imageUrl=e,this.showImagePanel=!0},saveData:function(){var e=[{}];e[0].parentID=this.detailObj.id,e[0].type=5,e[0].lifePointList=[{}],e[0].lifePointList[0].index=1,e[0].lifePointList[0].approverID=this.approverID,e[0].lifePointList[0].approverAvatarUrl=this.approverAvatarUrl,e[0].lifePointList[0].approverName=this.approverName,e[0].reply_info=this.des,this.taskLifeList=e,this.source={des:this.des}},onClickToSave:function(){var e=this;this.saveData(),1===this.$store.getters.currentRole?this.path="chairmanList":3===this.$store.getters.currentRole?this.path="list-clerk":4===this.$store.getters.currentRole||2===this.$store.getters.currentRole?this.path="listSourceAdmin":this.path="list",setTimeout(function(){if(!e.validatorVisible){var t=e.$url+"/taskSystem/task/life";e.loading=!0,l()({method:"post",url:t,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:c.a.stringify({jsonStr:JSON.stringify(e.taskLifeList)})}).then(function(t){e.loading=!1,e.tipVisible=!0,!0===t.data.success?e.success=!0:(e.tipFailedDesc=t.data.outerMessage,e.success=!1)})}},0)}},"onClickToChooseApprover",function(){var e=this;qing.call("selectPersons",{isMulti:!1,success:function(t){e.approverAvatarUrl=t.data.persons[0].avatarUrl,e.approverName=t.data.persons[0].name,e.approverID=t.data.persons[0].openId}})}),beforeDestroy:function(){this.urlObj=[]}},d=p,u=(a("945b"),a("2877")),v=Object(u["a"])(d,i,s,!1,null,"feee7f04",null);t["default"]=v.exports},"454f":function(e,t,a){a("46a7");var i=a("584a").Object;e.exports=function(e,t,a){return i.defineProperty(e,t,a)}},"46a7":function(e,t,a){var i=a("63b6");i(i.S+i.F*!a("8e60"),"Object",{defineProperty:a("d9f6").f})},"85f2":function(e,t,a){e.exports=a("454f")},"945b":function(e,t,a){"use strict";var i=a("e757"),s=a.n(i);s.a},bd86:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var i=a("85f2"),s=a.n(i);function r(e,t,a){return t in e?s()(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},e757:function(e,t,a){}}]);