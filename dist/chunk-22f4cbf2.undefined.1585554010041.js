(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22f4cbf2"],{a2b4:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{height:"100%"}},[e("div",{staticClass:"parent-tabwrap"},[e("c-tab",{attrs:{titlebar:t.titlebar1,currentIndex:t.tabCurrentIndex,"show-num":!0},on:{"update:currentIndex":function(a){return t.getCurrentIndex(a)}}})],1),e("div",{staticClass:"swiper-container first-container swiper-no-swiping"},[e("div",{staticClass:"swiper-wrapper"},[e("div",{staticClass:"swiper-slide"},[e("div",{ref:"wrapper1_1",staticClass:"list-wrap 111"},[e("div",{staticClass:"task"},t._l(t.list1,function(a){return e("div",{staticClass:"charger-wrap"},[e("div",{staticClass:"charger-name",staticStyle:{"font-size":"12px"}},[e("span",{staticClass:"left"},[t._v(t._s(a.name))]),e("div",{staticClass:"toggle-bottom"},[e("div",{on:{click:function(e){return t.onClickToggle(e,a)}}},[a.folded?e("p",{staticClass:"unfolded"},[e("span",[t._v("展开")]),e("i",{staticClass:"icon"})]):e("p",[e("span",[t._v("收起")]),e("i",{staticClass:"icon"})])])])]),t._l(a.lifelist,function(s){return e("router-link",{key:s.id,staticClass:"router-link",class:{folded:a.folded},attrs:{tag:"div",to:{name:"processdetail",params:{detailObj:JSON.stringify(s),canWrite:!1}}}},[e("div",{staticClass:"head"},[e("div",{staticClass:"title"},[t._v("\n                                        "+t._s(s.projectName)+"\n                                        "),t.$showReward(s.reward)&&3===s.type&&3===s.state?e("span",{staticClass:"reward"},[t._v("(+"+t._s(s.reward)+"分)")]):t._e()]),e("div",{staticClass:"date"},[t._v(t._s(t.getLifeType(s.type)))])]),e("div",{staticClass:"middle"},[e("span",[t._v("责任人：")]),e("span",[t._v(t._s(s.chargerName))])]),e("div",{staticClass:"bottom"},[e("div",{staticClass:"tags"},[0===s.listState?e("p",[e("span",[t._v("新增")])]):t._e(),1===s.listState?e("p",[e("span",[t._v("退回")])]):t._e(),2===s.listState?e("p",[e("span",[t._v("审批中")])]):t._e(),3===s.listState?e("p",[e("span",[t._v("通过")])]):t._e(),4===s.listState?e("p",[e("span",[t._v("未通过")])]):t._e(),5===s.listState?e("p",[e("span",[t._v("关闭")])]):t._e()])])])}),e("Loading",{attrs:{showloadingwrap:t.showLoadingWrap1,showloadingimg:t.showLoadingImg1}})],2)}),0)])]),e("div",{staticClass:"swiper-slide"},[e("div",{ref:"wrapper1_2",staticClass:"list-wrap 222"},[e("div",{staticClass:"task"},t._l(t.list2,function(a){return e("div",{staticClass:"charger-wrap"},[e("div",{staticClass:"charger-name",staticStyle:{"font-size":"12px"}},[e("span",{staticClass:"left"},[t._v(t._s(a.name))]),e("div",{staticClass:"toggle-bottom"},[e("div",{on:{click:function(e){return t.onClickToggle(e,a)}}},[a.folded?e("p",{staticClass:"unfolded"},[e("span",[t._v("展开")]),e("i",{staticClass:"icon"})]):e("p",[e("span",[t._v("收起")]),e("i",{staticClass:"icon"})])])])]),t._l(a.lifelist,function(s){return e("router-link",{key:s.id,staticClass:"router-link",class:{folded:a.folded},attrs:{tag:"div",to:{name:"processdetail",params:{detailObj:JSON.stringify(s),canWrite:!1}}}},[e("div",{staticClass:"head"},[e("div",{staticClass:"title"},[t._v("\n                                        "+t._s(s.projectName)+"\n                                        "),t.$showReward(s.reward)&&3===s.type&&3===s.state?e("span",{staticClass:"reward"},[t._v("(+"+t._s(s.reward)+"分)")]):t._e()]),e("div",{staticClass:"date"},[t._v(t._s(t.getLifeType(s.type)))])]),e("div",{staticClass:"middle"},[e("span",[t._v("责任人：")]),e("span",[t._v(t._s(s.chargerName))])]),e("div",{staticClass:"bottom"},[e("div",{staticClass:"tags"},[0===s.listState?e("p",[e("span",[t._v("新增")])]):t._e(),1===s.listState?e("p",[e("span",[t._v("退回")])]):t._e(),2===s.listState?e("p",[e("span",[t._v("审批中")])]):t._e(),3===s.listState?e("p",[e("span",[t._v("通过")])]):t._e(),4===s.listState?e("p",[e("span",[t._v("未通过")])]):t._e(),5===s.listState?e("p",[e("span",[t._v("关闭")])]):t._e()])])])}),e("Loading",{attrs:{showloadingwrap:t.showLoadingWrap2,showloadingimg:t.showLoadingImg2}})],2)}),0)])])])])])},i=[],r=(e("c5f6"),e("ac6a"),e("5df3"),e("7f7f"),e("41d6")),n=e("bc3a"),o=e.n(n),l=e("4328"),c=e.n(l),d=(e("1fba"),[{name:"我负责的"},{name:"我审批的"}]),p={name:"process-center-clerk",components:{},data:function(){return{btnTitle:d,titlebar1:[{name:"审批中",num:0},{name:"已审批",num:0}],detailSwiper:null,tabCurrentIndex:0,showLoadingWrap1:!1,showLoadingWrap2:!1,showLoadingImg1:!1,showLoadingImg2:!1,list1:[],list2:[],scroll1:null,scroll2:null,openId:"",process_taskType:"",process_taskStatus:"",charge:{},approve:{},leaderArr:[]}},watch:{tabCurrentIndex:function(){console.log("this.tabCurrentIndex",this.tabCurrentIndex),localStorage.setItem("tabCurrentIndex",this.tabCurrentIndex),1===this.tabCurrentIndex?(console.log("!this.showLoadingWrap2 && this.list2.length === 0",!this.showLoadingWrap2&&0===this.list2.length),this.showLoadingWrap2||0!==this.list2.length||this.loadData(this.$store.state.openID,"charge","已审批",1,1e4)):0===this.tabCurrentIndex&&(this.showLoadingWrap1||0!==this.list1.length||this.loadData(this.$store.state.openID,"charge","审批中",1,1e4))}},beforeRouteEnter:function(t,a,e){qing.call("setWebViewTitle",{title:"流程中心"}),e(function(t){t.leaderArr=t.$store.getters.leaderArr,"index"===a.name||"clerkIndex"===a.name?(t.tabCurrentIndex=0,void 0!==t.tabCurrentIndex&&localStorage.setItem("tabCurrentIndex",t.tabCurrentIndex)):t.tabCurrentIndex=localStorage.getItem("tabCurrentIndex"),t.detailSwiper=new r["a"](".first-container",{on:{slideChangeTransitionStart:function(){t.tabCurrentIndex=t.detailSwiper.activeIndex}}}),t.detailSwiper.slideTo(t.tabCurrentIndex);var e="http://rest.apizza.net/mock/21c5cf3ed4022de252a80d8e8366c6f7/flowNum",s=t.leaderArr.map(function(t){return o.a.get(e,{params:{openIDStr:t.fleaderID}})});Promise.all(s).then(function(a){a.length>0&&a.forEach(function(a,e){if(a.data.result.length>0){var s=a.data.result[0],i=s.charge;s.approve;console.log(Number(i.checking)),console.log(Number(i.pass)),console.log(Number(i.back)),console.log(Number(i.pass)+Number(i.back)),t.titlebar1[0].num+=Number(i.checking),t.titlebar1[1].num+=Number(i.pass)+Number(i.back)}})}).catch(function(){alert("获取数量接口错误")}),t.loadData(t.$store.getters.openID,"","审批中",1,1e4)})},methods:{getCurrentIndex:function(t){console.log(t),this.tabCurrentIndex=t,this.detailSwiper.slideTo(t)},ajax:function(t,a,e,s,i,r){var n=this;switch(r){case 1:this.showLoadingWrap1=!0,this.showLoadingImg1=!0;break;case 2:this.showLoadingWrap2=!0,this.showLoadingImg2=!0;break;default:break}var l=this.leaderArr.map(function(e){var s=JSON.parse(a.queryTaskList);return s.forEach(function(t){t.chargerID&&(t.chargerID=e.fleaderID)}),a.queryTaskList=JSON.stringify(s),console.log("params.queryTaskList",a.queryTaskList),o()({method:"post",url:t,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:c.a.stringify(a)})});Promise.all(l).then(function(t){if(t.forEach(function(t,a){var s=t.data.result.amount;if(s>0){var i=t.data.result.data,r=[];if(i.forEach(function(t){t.taskLifeList.forEach(function(a){a.taskID=t.id,a.projectName=t.projectName,a.chargerName=t.chargerName,a.sourceList=t.sourceList,a.starttime=t.starttime,a.endtime=t.endtime,a.unitName=t.unitName,a.signerName=t.signerName,a.helperName=t.helperName,a.imgs=t.imgs,a.problem=t.problem,a.ways=t.ways,a.aim=t.aim,a.taskState=t.state,a.reward=t.reward,a.listState=t.taskLifeList[0].state;var e=0;t.taskLifeList.forEach(function(t){2===t.type&&(e+=1)}),a.changeTimes=e,r.push(a)})}),r.length>0){var o={};o.id=n.leaderArr[a].fleaderID,o.name=n.leaderArr[a].fleaderName,o.lifelist=r,e.push(o)}}}),e.length>0)switch(e.forEach(function(t){n.$set(t,"folded",!1)}),r){case 1:n.showLoadingWrap1=!1,n.showLoadingImg1=!1;break;case 2:n.showLoadingWrap2=!0,n.showLoadingImg2=!1;break;default:break}else switch(r){case 1:n.showLoadingWrap1=!0,n.showLoadingImg1=!1;break;case 2:n.showLoadingWrap2=!0,n.showLoadingImg2=!1;break;default:break}s&&(s.finishPullUp(),s.refresh()),n.$initScroll(s,i)}).catch(function(t){switch(r){case 1:n.showLoadingWrap1=!0,n.showLoadingImg1=!1;break;case 2:n.showLoadingWrap2=!0,n.showLoadingImg2=!1;break;default:break}})},loadData:function(t,a,e,s,i){console.log(t,a,e,s,i);var r={point_state:void 0,chargerID:t},n="http://rest.apizza.net/mock/21c5cf3ed4022de252a80d8e8366c6f7/flowList";if("审批中"===e){r.life_state=2,this.showLoadingWrap1=!0,this.showLoadingImg1=!0;var o=[];o.push(r);var l={page:s,pageAmount:i,queryTaskList:JSON.stringify(o)};this.ajax(n,l,this.list1,this.scroll1,this.$refs.wrapper1_1,1)}else if("已审批"===e){r.life_state=3;var c={life_state:4,chargerID:t};this.showLoadingWrap2=!0,this.showLoadingImg2=!0;var d=[];d.push(r),d.push(c);var p={page:s,pageAmount:i,queryTaskList:JSON.stringify(d)};this.ajax(n,p,this.list2,this.scroll2,this.$refs.wrapper1_2,2)}},getLifeType:function(t){var a="";switch(t){case 1:a="新增";break;case 2:a="变更";break;case 3:a="完结";break;case 4:a="废止";break;case 5:a="反馈";break;case 6:a="传阅";break;default:a="";break}return a},onClickToggle:function(t,a){t.stopPropagation(),a.folded=!a.folded},judgeTarget:function(t){var a,e=t.lifePointList.length;if(e>0){var s=t.lifePointList[t.lifePointList.length-1].state;if(2===s||3===s.state)a=s;else for(var i=0;i<e;i++)if(2!==t.lifePointList[i].state){a=t.lifePointList[i].state;break}}else a=-1;return a}}},h=p,g=(e("c276"),e("2877")),u=Object(g["a"])(h,s,i,!1,null,"2d34021e",null);a["default"]=u.exports},b3ca:function(t,a,e){},c276:function(t,a,e){"use strict";var s=e("b3ca"),i=e.n(s);i.a}}]);