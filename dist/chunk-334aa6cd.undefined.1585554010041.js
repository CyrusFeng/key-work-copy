(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-334aa6cd"],{"2d6a":function(e,a,t){},6871:function(e,a,t){"use strict";var r=t("2d6a"),s=t.n(r);s.a},d2b1:function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticStyle:{height:"100%"}},[t("div",{ref:"wrapper",staticClass:"scroll-wrap",staticStyle:{height:"calc(100% - 0.45rem)",overflow:"hidden"}},[t("div",[t("div",{staticClass:"block"},[t("div",{staticClass:"title-wrap"},[t("field-title",{attrs:{"blueline-visible":!1,"redstar-visible":!1}},[e._v("废止申请")])],1),t("div",{staticClass:"text"},[t("div",{staticClass:"radio"},[t("c-radio",{attrs:{options:e.options},on:{"value-change":function(a){return e.radioOnChange(a)}}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:1===e.isSubjective,expression:"isSubjective===1"}]},[t("c-textarea",{attrs:{"default-value":"",remark:"",tips:"请输入主观原因"},on:{"update:inputValue":function(a){e.reason1=a}}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:2===e.isSubjective,expression:"isSubjective===2"}]},[t("c-textarea",{attrs:{"default-value":"",remark:"",tips:"请输入客观原因"},on:{"update:inputValue":function(a){e.reason2=a}}})],1)])]),"charge"===e.$store.state.taskType&&3===e.$store.getters.currentRole?t("div",{staticClass:"block approver"},[t("div",{staticClass:"title-wrap"},[t("div",[t("field-title",{attrs:{"blueline-visible":!1,"redstar-visible":!1}},[e._v("责任人审批")])],1),t("i",{staticClass:"icon",on:{click:e.onClickToChooseCharger}})]),t("div",{staticClass:"des-wrap"},[t("div",{staticClass:"wrap"},[t("div",{staticClass:"left"},[e.chargerAvatarUrl?t("img",{attrs:{src:e.chargerAvatarUrl}}):e._e()]),t("div",{staticClass:"right"},[t("span",[e._v(e._s(e.chargerName))])])])])]):e._e(),"charge"===e.$store.state.taskType&&2!==e.$store.getters.currentRole&&4!==e.$store.getters.currentRole?t("div",{staticClass:"block approver"},[t("div",{staticClass:"title-wrap"},[t("div",[t("field-title",{attrs:{"blueline-visible":!1,"redstar-visible":!1}},[e._v("上级领导审批")])],1),t("i",{staticClass:"icon",on:{click:e.onClickToChooseChargersLeader}})]),t("div",{staticClass:"des-wrap"},[t("div",{staticClass:"wrap"},[t("div",{staticClass:"left"},[e.chargersLeaderAvatarUrl?t("img",{attrs:{src:e.chargersLeaderAvatarUrl}}):e._e()]),t("div",{staticClass:"right"},[t("span",[e._v(e._s(e.chargersLeaderName))])])])])]):e._e()])]),t("div",{staticClass:"button-wrap"},[t("div",{staticClass:"btn2",on:{click:e.onClickToSave}},[t("span",[e._v("发送")])])]),t("image-panel",{attrs:{url:e.imageUrl,showImagePanel:e.showImagePanel},on:{"update:showImagePanel":function(a){e.showImagePanel=a},"update:show-image-panel":function(a){e.showImagePanel=a}}}),t("FullPageLoading",{attrs:{loading:e.loading}}),t("FullPageLoading",{attrs:{loading:e.loading1}}),t("FullPageLoading",{attrs:{loading:e.loading2}}),t("StatePage",{attrs:{success:e.success,tipVisible:e.tipVisible,tipFailedDesc:e.tipFailedDesc,"jump-to":e.path},on:{"update:tipVisible":function(a){e.tipVisible=a}}}),t("Validator",{attrs:{source:e.source,validatorVisible:e.validatorVisible,orderType:"Flow"},on:{"update:validatorVisible":function(a){e.validatorVisible=a}}})],1)},s=[],i=(t("ac6a"),t("7f7f"),t("bc3a")),o=t.n(i),l=t("4328"),c=t.n(l),n={name:"abolish",data:function(){return{isSubjective:1,reason1:"",reason2:"",options:[{label:"主观原因",value:1},{label:"客观原因",value:2}],imageUrl:"",showImagePanel:!1,loading:!1,loading1:!1,loading2:!1,tipVisible:!1,success:!1,urlObj:[],approverName:"",approverAvatarUrl:"",approverID:"",chargerID:"",chargerName:"",chargerAvatarUrl:"",chargersLeaderID:"",chargersLeaderName:"",chargersLeaderAvatarUrl:"",leadersLeader:{},singerObj:{},scroll:null,detailObj:{},source:{},validatorVisible:!1,taskLifeList:[],path:"",tipFailedDesc:""}},beforeRouteEnter:function(e,a,t){qing.call("setWebViewTitle",{title:"废止"}),t(function(e){if("taskdetail"===a.name){var t=e.$route.params.detailObj;e.detailObj=t,console.log("vm.detailObj",e.detailObj),e.detailObj&&localStorage.setItem("detailObj",JSON.stringify(e.detailObj))}else e.detailObj=JSON.parse(localStorage.getItem("detailObj"));e.urlObj=[],e.detailObj.chargerID&&(e.loading1=!0,e.$getPersonInfoByOpenID(e.detailObj.chargerID).then(function(a){var t=a.data.result.data[0];e.chargerID=t.openId,e.chargerName=t.name,e.chargerAvatarUrl=t.photoUrl,e.loading1=!1}).catch(function(e){alert("获取责任人信息失败")})),e.detailObj.signerID&&null!==e.detailObj.signerID&&(e.loading3=!0,e.$getPersonInfoByOpenID(e.detailObj.signerID).then(function(a){var t=a.data.result.data[0];e.chargersLeaderID=t.openId,e.chargersLeaderName=t.name,e.chargersLeaderAvatarUrl=t.photoUrl,e.$store.getters.openID===e.chargersLeaderID&&(e.chargersLeaderID="",e.chargersLeaderName="",e.chargersLeaderAvatarUrl=""),e.loading3=!1}).catch(function(e){alert("获取主管领导信息失败")}))})},mounted:function(){this.$initScroll(this.scroll,this.$refs.wrapper)},beforeDestroy:function(){this.urlObj=[]},methods:{radioOnChange:function(e){this.isSubjective=e,console.log(e)},onClickToChooseImage:function(){var e=this;qing.call("chooseImage",{type:"camera",needCut:!1,isMulti:!0,maxSelectCount:9,showOrigin:!1,success:function(a){a.data.localIds.forEach(function(a){qing.call("uploadImage",{localId:a,isShowProgressTips:1,success:function(a){if("true"===a.success||!0===a.success){var t=a.data.serverId;e.urlObj.push({url:"https://yunzhijia.com//openfile/download/media/".concat(t),showLoading:!0})}else alert("图片上传失败，请重试")}})})}})},onClickToChooseCharger:function(){var e=this;qing.call("selectPersons",{isMulti:!1,success:function(a){e.chargerAvatarUrl=a.data.persons[0].avatarUrl,e.chargerName=a.data.persons[0].name,e.chargerID=a.data.persons[0].openId}})},onClickToChooseChargersLeader:function(){var e=this;qing.call("selectPersons",{isMulti:!1,success:function(a){e.chargersLeaderAvatarUrl=a.data.persons[0].avatarUrl,e.chargersLeaderName=a.data.persons[0].name,e.chargersLeaderID=a.data.persons[0].openId}})},onClickImage:function(e){this.imageUrl=e,this.showImagePanel=!0},saveData:function(){var e=[{}];if(e[0].parentID=this.detailObj.id,e[0].type=4,e[0].lifePointList=[],3===this.$store.getters.currentRole){var a={index:1};a.approverID=this.detailObj.chargerID,a.approverAvatarUrl="",a.approverName=this.detailObj.chargerName,e[0].lifePointList.push(a);var t={index:2};if(t.approverID=this.chargersLeaderID,t.approverAvatarUrl=this.chargersLeaderAvatarUrl,t.approverName=this.chargersLeaderName,this.chargersLeaderID===localStorage.getItem("chairmanId"))if(1==this.detailObj.sourceID||2==this.detailObj.sourceID||3==this.detailObj.sourceID||4==this.detailObj.sourceID||7==this.detailObj.sourceID){var r={approverID:"57c0f003e4b01de693d52384",approverName:"晏宁",approverAvatarUrl:"https://static.yunzhijia.com/space/c/photo/load?id=5e0c0d946d67ff33eb8b830d",index:2};e[0].lifePointList.push(r),t.index=3,e[0].lifePointList.push(t)}else e[0].lifePointList.push(t);else e[0].lifePointList.push(t)}else if(2===this.$store.getters.currentRole||4===this.$store.getters.currentRole){var s={index:1};s.approverID=this.$store.state.openID,s.approverAvatarUrl=this.$store.state.avatarUrl,s.approverName=this.$store.state.name,e[0].lifePointList.push(s)}else{var i={index:1};if("charge"===this.$store.state.taskType?(i.approverID=this.chargersLeaderID,i.approverAvatarUrl=this.chargersLeaderAvatarUrl,i.approverName=this.chargersLeaderName):"sign"===this.$store.state.taskType&&(i.approverID=this.$store.state.openID,i.approverAvatarUrl=this.$store.state.avatarUrl,i.approverName=this.$store.state.name),e[0].lifePointList.push(i),"charge"===this.$store.state.taskType&&this.chargersLeaderID===localStorage.getItem("chairmanId")&&(1==this.detailObj.sourceID||2==this.detailObj.sourceID||3==this.detailObj.sourceID||4==this.detailObj.sourceID||7==this.detailObj.sourceID)){var o={approverID:"57c0f003e4b01de693d52384",approverName:"晏宁",approverAvatarUrl:"https://static.yunzhijia.com/space/c/photo/load?id=5e0c0d946d67ff33eb8b830d",index:1};e[0].lifePointList[0].index=2,e[0].lifePointList.unshift(o)}}e[0].cancel_type=this.isSubjective,1===this.isSubjective?e[0].cancel_reason=this.reason1:2===this.isSubjective&&(e[0].cancel_reason=this.reason2),this.taskLifeList=e,"charge"===this.$store.state.taskType&&(3===this.$store.getters.currentRole?1===this.isSubjective?this.source={chargerID:this.chargerID,chargersLeaderID:this.chargersLeaderID,reason1:this.reason1}:this.source={chargerID:this.chargerID,chargersLeaderID:this.chargersLeaderID,reason2:this.reason2}:2===this.$store.getters.currentRole||4===this.$store.getters.currentRole?1===this.isSubjective?this.source={reason1:this.reason1}:this.source={reason2:this.reason2}:1===this.isSubjective?this.source={chargersLeaderID:this.chargersLeaderID,reason1:this.reason1}:this.source={chargersLeaderID:this.chargersLeaderID,reason2:this.reason2})},onClickToSave:function(){var e=this;this.saveData(),1===this.$store.getters.currentRole?this.path="chairmanList":3===this.$store.getters.currentRole?this.path="list-clerk":4===this.$store.getters.currentRole||2===this.$store.getters.currentRole?this.path="listSourceAdmin":this.path="list",setTimeout(function(){if(!e.validatorVisible){var a=e.$url+"/taskSystem/task/life";e.loading=!0,o()({method:"post",url:a,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:c.a.stringify({jsonStr:JSON.stringify(e.taskLifeList)})}).then(function(a){e.loading=!1,e.tipVisible=!0,!0===a.data.success?e.success=!0:(e.tipFailedDesc=a.data.outerMessage,e.success=!1),e.urlObj=[]})}},0)}}},h=n,d=(t("6871"),t("2877")),u=Object(d["a"])(h,r,s,!1,null,"42959426",null);a["default"]=u.exports}}]);