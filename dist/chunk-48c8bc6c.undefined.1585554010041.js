(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48c8bc6c"],{"1eb6":function(t,e,a){},3794:function(t,e,a){"use strict";var s=a("1eb6"),i=a.n(s);i.a},"6afa":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"block field"},[a("div",{staticClass:"title-wrap"},[a("field-title",{attrs:{"blueline-visible":!1,"redstar-visible":!1}},[t._v("基本信息")])],1),a("div",{staticClass:"content",class:{folded:!t.folded}},[a("div",{staticClass:"row"},[t._m(0),a("div",{staticClass:"right"},[a("c-input",{attrs:{defaultValue:"",defaultType:"",tips:"请输入"},on:{"update:inputValue":function(e){t.projectName=e}}})],1)]),a("div",{staticClass:"row"},[t._m(1),a("div",{staticClass:"right yunzhijia"},[a("span",[t._v(t._s(t.charger_name||"请选择"))]),a("i",{staticClass:"icon",on:{click:t.onClickToChooseCharger}})])]),a("div",{staticClass:"row"},[t._m(2),a("div",{staticClass:"right",on:{click:function(e){t.isVisible1=!t.isVisible1}}},[a("span",[t._v(t._s(t.starttime||"请选择"))])])]),a("div",{staticClass:"row"},[t._m(3),a("div",{staticClass:"right",on:{click:function(e){t.isVisible2=!t.isVisible2}}},[a("span",[t._v(t._s(t.endtime||"请选择"))])])]),a("div",{staticClass:"row"},[t._m(4),a("div",{staticClass:"right",on:{click:function(e){t.isVisible3=!t.isVisible3}}},[a("c-select",{attrs:{orgRange:t.sourceArr,defaultValueId:t.sourceID},on:{"update:itemObj":function(e){return t.chooseSource(e)}}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"label"},[t._v("单位")]),a("div",{staticClass:"right yunzhijia clearAble"},[a("span",[t._v(t._s(t.unitName||"请选择"))]),a("div",{staticClass:"icon-wrap"},[a("i",{staticClass:"icon iconClear",on:{click:t.clearCompany}}),a("i",{staticClass:"icon",on:{click:t.onClickToChooseCompany}})])])]),2==t.$store.getters.currentRole||4==t.$store.getters.currentRole?a("div",{staticClass:"row"},[a("div",{staticClass:"label"},[t._v("签发人")]),a("div",{staticClass:"right yunzhijia clearAble"},[a("span",[t._v(t._s(t.signerName||"请选择"))]),a("div",{staticClass:"icon-wrap"},[a("i",{staticClass:"icon iconClear",on:{click:t.clearSigner}}),a("i",{staticClass:"icon",on:{click:t.onClickToChooseSigner}})])])]):a("div",{staticClass:"row"},[a("div",{staticClass:"label"},[t._v("签发人")]),a("div",{staticClass:"right yunzhijia clearAble"},[a("span",[t._v(t._s(t.signerName||"暂无签发人"))])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"label"},[t._v("协助人")]),a("div",{staticClass:"right yunzhijia clearAble"},[a("span",[t._v(t._s(t.helperName||"请选择"))]),a("div",{staticClass:"icon-wrap"},[a("i",{staticClass:"icon iconClear",on:{click:t.clearHelper}}),a("i",{staticClass:"icon",on:{click:t.onClickToChooseHelper}})])])])]),a("div",{staticClass:"bottom"},[a("div",{on:{click:function(e){t.folded=!t.folded}}},[t.folded?a("p",[a("span",[t._v("展开")]),a("i",{staticClass:"icon"})]):a("p",{staticClass:"unfolded"},[a("span",[t._v("收起")]),a("i",{staticClass:"icon"})])])])]),a("div",{staticClass:"block"},[a("div",{staticClass:"title-wrap"},[a("field-title",{attrs:{"blueline-visible":!1,"redstar-visible":!1}},[t._v("现状及问题")])],1),a("div",{staticClass:"text"},[a("c-textarea",{attrs:{"default-value":"",remark:"",tips:"请输入"},on:{"update:inputValue":function(e){t.problem=e}}})],1)]),a("div",{staticClass:"block"},[a("div",{staticClass:"title-wrap"},[a("field-title",{attrs:{"blueline-visible":!1,"redstar-visible":!1}},[t._v("实施方法")])],1),a("div",{staticClass:"text"},[a("c-textarea",{attrs:{"default-value":"",remark:"",tips:"请输入"},on:{"update:inputValue":function(e){t.ways=e}}})],1)]),a("div",{staticClass:"block"},[a("div",{staticClass:"title-wrap"},[a("field-title",{attrs:{"blueline-visible":!1,"redstar-visible":!0}},[t._v("预期目标")])],1),a("div",{staticClass:"text"},[a("c-textarea",{attrs:{"default-value":"",remark:"",tips:"请输入"},on:{"update:inputValue":function(e){t.aim=e}}})],1)]),a("div",{staticClass:"button-wrap"},[a("div",{staticClass:"btn2",on:{click:t.onClickToSave}},[a("span",[t._v("发送")])])]),a("image-panel",{attrs:{url:t.imageUrl,showImagePanel:t.showImagePanel},on:{"update:showImagePanel":function(e){t.showImagePanel=e},"update:show-image-panel":function(e){t.showImagePanel=e}}}),a("nut-datepicker",{attrs:{"is-visible":t.isVisible1,type:"date",title:"请选择日期","is-show-chinese":!1,defaultValue:t.today,endDate:"2199-10-05"},on:{close:function(e){return t.switchPicker("isVisible1")},choose:t.setChooseValue1}}),a("nut-datepicker",{attrs:{"is-visible":t.isVisible2,type:"date",title:"请选择日期","is-show-chinese":!1,defaultValue:t.today,endDate:"2199-10-05"},on:{close:function(e){return t.switchPicker("isVisible2")},choose:t.setChooseValue2}}),a("StatePage",{attrs:{success:t.success,tipVisible:t.tipVisible,"jump-to":t.pathname},on:{"update:tipVisible":function(e){t.tipVisible=e}}}),a("FullPageLoading",{attrs:{loading:t.loading}}),a("Validator",{attrs:{source:t.source,validatorVisible:t.validatorVisible},on:{"update:validatorVisible":function(e){t.validatorVisible=e}}})],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label"},[t._v("项目名称 "),a("span",{staticClass:"star"},[t._v("*")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label"},[t._v("责任人 "),a("span",{staticClass:"star"},[t._v("*")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label"},[t._v("启动时间 "),a("span",{staticClass:"star"},[t._v("*")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label"},[t._v("完成时间 "),a("span",{staticClass:"star"},[t._v("*")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"label"},[t._v("工作来源 "),a("span",{staticClass:"star"},[t._v("*")])])}],r=(a("ac6a"),a("7f7f"),a("bc3a")),n=a.n(r),o=a("4328"),l=a.n(o),c=a("e0eb"),u=[],d={name:"tempAdd",data:function(){return{folded:!0,tipVisible:!1,success:!1,loading:!1,urlObj:u,sourceArr:[],sourceNameArr:[],imageUrl:void 0,showImagePanel:!1,saveData:{},projectName:void 0,chargerName:void 0,sourceID:void 0,sourceName:void 0,defaultSource:{},starttime:void 0,endtime:void 0,unitID:void 0,unitName:void 0,signerID:void 0,signerName:void 0,helperID:void 0,helperName:void 0,problem:void 0,ways:void 0,aim:void 0,imgs:void 0,appendixs:void 0,approverID:void 0,approverName:void 0,approverAvatarUrl:void 0,isVisible1:!1,isVisible2:!1,isVisible3:!1,date1:void 0,date2:void 0,index:1,openId:void 0,charger_name:void 0,chargerID:void 0,today:c["a"].getYearMonthDayString(new Date),source:{},validatorVisible:!1,pathname:"list"}},beforeRouteEnter:function(t,e,a){a(function(t){qing.call("setWebViewTitle",{title:"临时下发"})})},mounted:function(){var t=this;this.signerID=this.$store.getters.openID,this.signerName=this.$store.state.name,1===this.$store.getters.currentRole?this.pathname="chairmanIndex":2===this.$store.getters.currentRole?this.pathname="listSourceAdmin":3===this.$store.getters.currentRole?this.pathname="list-clerk":4===this.$store.getters.currentRole?this.pathname="listSourceAdmin":0===this.$store.getters.currentRole&&(this.pathname="list");var e="http://rest.apizza.net/mock/21c5cf3ed4022de252a80d8e8366c6f7/source/list";if(n.a.get(e,{params:{}}).then(function(e){if(t.sourceArr=e.data.result,t.sourceArr.unshift({name:"请选择",id:0}),1===t.$store.getters.currentRole)for(var a=0;a<t.sourceArr.length;a++)"主席安排"===t.sourceArr[a].name&&(t.sourceID=t.sourceArr[a].id)}),0===this.$store.getters.currentRole){var a={eid:"8738001",openId:this.$store.getters.openID},s=this.$url+"/taskSystem/intf/cloud";n.a.get(s,{params:{url:"/gateway/opendata-control/data/getperson",dataStr:JSON.stringify(a),authorize:"app"}}).then(function(e){console.log(e.data.result.data[0].orgId);var a=e.data.result.data[0].orgId,i=e.data.result.data[0].department;t.unitID=a,t.unitName=i;var r={eid:"8738001",orgId:a};n.a.get(s,{params:{url:"/gateway/opendata-control/data/getorg",dataStr:JSON.stringify(r),authorize:"app"}}).then(function(e){console.log(e.data.result.data.inChargers[0]);var a=e.data.result.data.inChargers;if(a[0]){var s=a[0];t.approverID=s.openId,t.approverName=s.name,t.approverAvatarUrl=s.photoUrl}})}).catch(function(t){})}},methods:{onClickToRemoveImg:function(t,e){console.log(t),t.stopPropagation(),this.urlObj.splice(this.urlObj.indexOf(e),1)},onClickImage:function(t){this.imageUrl=t,this.showImagePanel=!0},saveDate:function(){this.saveData={},this.saveData.taskLifeList=[{}],this.saveData.taskLifeList[0].lifePointList=[{}],this.saveData.projectName=this.projectName,this.saveData.chargerID=this.chargerID,this.saveData.chargerName=this.charger_name,this.saveData.sourceID=this.sourceID,this.saveData.starttime=this.starttime,this.saveData.endtime=this.endtime,this.saveData.unitID=this.unitID,this.saveData.unitName=this.unitName,this.saveData.signerID=this.signerID,this.saveData.signerName=this.signerName,this.saveData.helperID=this.helperID,this.saveData.helperName=this.helperName,this.saveData.problem=this.problem,this.saveData.ways=this.ways,this.saveData.aim=this.aim,this.saveData.imgs=this.imgs,this.saveData.level=1,this.saveData.state=1,this.saveData.taskLifeList[0].type=1,this.saveData.taskLifeList[0].lifePointList[0].approverID=this.signerID||this.$store.getters.openID,this.saveData.taskLifeList[0].lifePointList[0].approverName=this.signerName||this.$store.state.name,this.saveData.taskLifeList[0].lifePointList[0].approverAvatarUrl=this.$store.state.avatarUrl,this.saveData.taskLifeList[0].lifePointList[0].index=this.index,console.log(this.saveData),console.log(JSON.stringify(this.saveData)),this.source={projectName:this.projectName,chargerName:this.charger_name,starttime:this.starttime,endtime:this.endtime,aim:this.aim,sourceID:this.sourceID}},onClickToSave:function(){var t=this;this.saveDate(),setTimeout(function(){if(!t.validatorVisible){var e=t.$url+"/taskSystem/task/task";t.loading=!0,n()({method:"post",url:e,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:l.a.stringify({jsonStr:JSON.stringify([t.saveData])})}).then(function(e){t.loading=!1,t.tipVisible=!0,!0===e.data.success?t.success=!0:t.success=!1}).catch(function(){}).finally(function(){})}},0)},beforeDestroy:function(){this.urlObj=[]},onClickToChooseCharger:function(){var t=this;qing.call("selectPersons",{isMulti:!1,success:function(e){t.chargerID=e.data.persons[0].openId,t.charger_name=e.data.persons[0].name,t.getOrgID(t.chargerID).then(function(e){var a=e.data.result.data[0].orgId,s=e.data.result.data[0].department;t.unitID=a,t.unitName=s})}})},getOrgID:function(t){var e={eid:"8738001",openId:t},a=this.$url+"/taskSystem/intf/cloud";return n.a.get(a,{params:{url:"/gateway/opendata-control/data/getperson",dataStr:JSON.stringify(e),authorize:"app"}})},onClickToChooseHelper:function(){var t=this,e=[],a=[];qing.call("selectPersons",{isMulti:!0,success:function(s){s.data.persons.forEach(function(t){e.push(t.openId),a.push(t.name)}),t.helperID=e.join(","),t.helperName=a.join(",")}})},onClickToChooseSigner:function(){var t=this;qing.call("selectPersons",{isMulti:!1,success:function(e){t.signerID=e.data.persons[0].openId,t.signerName=e.data.persons[0].name}})},onClickToChooseCompany:function(){var t=this;qing.call("selectOrgs",{isMulti:!1,success:function(e){t.unitID=e.data.orgs[0].orgId,t.unitName=e.data.orgs[0].orgName}})},onClickToChooseImage:function(){var t=this;qing.call("chooseImage",{type:"camera",needCut:!1,isMulti:!0,maxSelectCount:9,showOrigin:!1,success:function(e){e.data.localIds.forEach(function(e){qing.call("uploadImage",{localId:e,isShowProgressTips:1,success:function(e){if("true"===e.success||!0===e.success){var a=e.data.serverId;t.urlObj.push({url:"https://yunzhijia.com//openfile/download/media/".concat(a),showLoading:!0})}else alert("图片上传失败，请重试")}})})}})},onClickToChooseApprover:function(){var t=this;qing.call("selectPersons",{isMulti:!1,success:function(e){t.approverAvatarUrl=e.data.persons[0].avatarUrl,t.approverName=e.data.persons[0].name,t.approverID=e.data.persons[0].openId}})},switchPicker:function(t){this["".concat(t)]=!this["".concat(t)]},setChooseValue1:function(t){this.starttime=t[3],this.endtime&&this.starttime&&(this.compareDate(this.endtime,this.starttime)||(alert("完成时间必须大于开始时间"),this.starttime=void 0,this.endtime=void 0))},setChooseValue2:function(t){this.endtime=t[3],this.endtime&&this.starttime&&(this.compareDate(this.endtime,this.starttime)||(alert("完成时间必须大于开始时间"),this.starttime=void 0,this.endtime=void 0))},compareDate:function(t,e){if(!t)return!1;if(!e)return!1;var a=new Date(t),s=new Date(e);return a.getTime()>s.getTime()},chooseSource:function(t){0===t.id?this.sourceID="":this.sourceID=t.id},clearHelper:function(){this.helperID=void 0,this.helperName=void 0},clearCompany:function(){this.unitID=void 0,this.unitName=void 0},clearSigner:function(){this.signerID=void 0,this.signerName=void 0}},watch:{urlObj:function(){var t=[];this.urlObj.forEach(function(e){t.push(e.url)}),this.imgs=t.join(",")}}},h=d,v=(a("3794"),a("2877")),p=Object(v["a"])(h,s,i,!1,null,"53aac1a9",null);e["default"]=p.exports}}]);