(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6cd66a5e"],{"26a1":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{height:"100%"}},[e("div",{staticClass:"parent-tabwrap"},[e("c-tab",{attrs:{titlebar:t.titlebar1,currentIndex:t.tabCurrentIndex,"show-num":!0},on:{"update:currentIndex":function(a){return t.getCurrentIndex(a)}}})],1),e("div",{staticClass:"swiper-container first-container swiper-no-swiping"},[e("div",{staticClass:"swiper-wrapper"},[e("div",{staticClass:"swiper-slide"},[e("div",{ref:"wrapper1_1",staticClass:"list-wrap 111"},[e("ul",{staticClass:"task"},[t._l(t.list1,function(a){return e("router-link",{key:a.id,attrs:{tag:"li",to:{name:"processdetail",params:{detailObj:JSON.stringify(a),canWrite:!0}}}},[e("div",{staticClass:"head"},[e("div",{staticClass:"title"},[t._v(t._s(a.projectName))]),e("div",{staticClass:"date"},[t._v(t._s(t.getLifeType(a.type)))])]),e("div",{staticClass:"middle"},[e("span",[t._v("责任人：")]),e("span",[t._v(t._s(a.chargerName))]),e("span",[t._v(t._s(a.coOperation?"（协办中）":""))])]),e("div",{staticClass:"bottom"},[e("div",{staticClass:"tags"},[0===t.judgeTarget(a)?e("p",[e("span",[t._v("待审批")])]):t._e(),1===t.judgeTarget(a)?e("p",[e("span",[t._v("审批中")])]):t._e(),2===t.judgeTarget(a)?e("p",[e("span",[t._v("通过")])]):t._e(),3===t.judgeTarget(a)?e("p",[e("span",[t._v("未通过")])]):t._e(),4===t.judgeTarget(a)?e("p",[e("span",[t._v("被退回")])]):t._e()])])])}),t.showLoadingWrap1?e("div",[e("Loading",{attrs:{showloadingwrap:t.showLoadingWrap1,showloadingimg:t.showLoadingImg1}})],1):t._e()],2)])]),e("div",{staticClass:"swiper-slide"},[e("div",{ref:"wrapper1_2",staticClass:"list-wrap 222"},[e("ul",{staticClass:"task"},[t._l(t.list2,function(a){return e("router-link",{key:a.id,attrs:{tag:"li",to:{name:"processdetail",params:{detailObj:JSON.stringify(a),canWrite:!1}}}},[e("div",{staticClass:"head"},[e("div",{staticClass:"title"},[t._v("\n                                    "+t._s(a.projectName)+"\n                                    "),t.$showReward(a.reward)&&3===a.type&&3===a.state?e("span",{staticClass:"reward"},[t._v("(+"+t._s(a.reward)+"分)")]):t._e()]),e("div",{staticClass:"date"},[t._v(t._s(t.getLifeType(a.type)))])]),e("div",{staticClass:"middle"},[e("span",[t._v("责任人：")]),e("span",[t._v(t._s(a.chargerName))])]),e("div",{staticClass:"bottom"},[e("div",{staticClass:"tags"},[0===t.judgeTarget(a)?e("p",[e("span",[t._v("待审批")])]):t._e(),1===t.judgeTarget(a)?e("p",[e("span",[t._v("审批中")])]):t._e(),2===t.judgeTarget(a)?e("p",[e("span",[t._v("通过")])]):t._e(),3===t.judgeTarget(a)?e("p",[e("span",[t._v("未通过")])]):t._e(),4===t.judgeTarget(a)?e("p",[e("span",[t._v("被退回")])]):t._e()])])])}),t.showLoadingWrap2?e("div",[e("Loading",{attrs:{showloadingwrap:t.showLoadingWrap2,showloadingimg:t.showLoadingImg2}})],1):t._e()],2)])])])])])},i=[],r=(e("ac6a"),e("7f7f"),e("41d6")),n=e("bc3a"),o=e.n(n),d=e("4328"),p=e.n(d),l=(e("1fba"),[{name:"我负责的"},{name:"我审批的"}]),c=[{name:"待审批",num:0},{name:"已审批",num:0}],g=[{name:"待审批",num:0},{name:"已审批",num:0}],h={name:"process-center-cm",components:{},data:function(){return{btnTitle:l,titlebar1:c,titlebar2:g,detailSwiper:null,tabCurrentIndex:0,showLoadingWrap1:!1,showLoadingWrap2:!1,showLoadingImg1:!1,showLoadingImg2:!1,list1:[],list2:[],scroll1:null,scroll2:null,openId:"",process_taskType:"",process_taskStatus:"",charge:{},approve:{}}},watch:{tabCurrentIndex:function(){console.log("this.tabCurrentIndex",this.tabCurrentIndex),localStorage.setItem("tabCurrentIndex",this.tabCurrentIndex),1===this.tabCurrentIndex?(console.log("!this.showLoadingWrap2 && this.list2.length === 0",!this.showLoadingWrap2&&0===this.list2.length),this.showLoadingWrap2||0!==this.list2.length||this.loadData(this.$store.state.openID,"charge","已审批",1,10)):0===this.tabCurrentIndex&&(this.showLoadingWrap1||0!==this.list1.length||this.loadData(this.$store.state.openID,"charge","审批中",1,10))}},beforeRouteEnter:function(t,a,e){qing.call("setWebViewTitle",{title:"流程中心"}),e(function(t){"index"===a.name||"chairmanIndex"===a.name?(t.tabCurrentIndex=0,void 0!==t.tabCurrentIndex&&localStorage.setItem("tabCurrentIndex",t.tabCurrentIndex)):t.tabCurrentIndex=localStorage.getItem("tabCurrentIndex"),t.detailSwiper=new r["a"](".first-container",{on:{slideChangeTransitionStart:function(){t.tabCurrentIndex=t.detailSwiper.activeIndex}}}),t.detailSwiper.slideTo(t.tabCurrentIndex);var e="http://rest.apizza.net/mock/21c5cf3ed4022de252a80d8e8366c6f7/getFlowAmount";o()({method:"post",url:e,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:p.a.stringify({jsonStr:JSON.stringify([{name:"checking",param:[{point_state:[1],point_approverID:t.$store.getters.openID,point_autoApprove:1}]},{name:"done",param:[{point_state:[2,3],point_approverID:t.$store.getters.openID,point_autoApprove:1}]}])})}).then(function(a){t.titlebar1[0].num=a.data.result.checking,t.titlebar1[1].num=a.data.result.done}),t.loadData(t.$store.getters.openID,"","审批中",1,10)})},methods:{getCurrentIndex:function(t){console.log(t),this.tabCurrentIndex=t,this.detailSwiper.slideTo(t)},ajax:function(t,a,e,s,i,r){var n=this;switch(r){case 1:this.showLoadingWrap1=!0,this.showLoadingImg1=!0;break;case 2:this.showLoadingWrap2=!0,this.showLoadingImg2=!0;break;default:break}o()({method:"post",url:t,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:p.a.stringify(a)}).then(function(o){if(console.log(o.data),o.data.result.data1.amount>0){switch(r){case 1:n.showLoadingWrap1=!1,n.showLoadingImg1=!1;break;case 2:n.showLoadingWrap2=!1,n.showLoadingImg1=!1;break;default:break}var d=o.data.result.data1.data,p=o.data.result.data2;console.log(o.data.result.data1.data);var l=[];d.forEach(function(t){t.taskLifeList.forEach(function(a){a.taskID=t.id,a.projectName=t.projectName,a.chargerName=t.chargerName,a.sourceList=t.sourceList,a.starttime=t.starttime,a.endtime=t.endtime,a.unitName=t.unitName,a.signerName=t.signerName,a.helperName=t.helperName,a.imgs=t.imgs,a.problem=t.problem,a.ways=t.ways,a.aim=t.aim,a.taskState=t.state,a.reward=t.reward,console.log(t.lifePointList),a.lifePointListLength=t.taskLifeList.length;var e=0;t.taskLifeList.forEach(function(t){2===t.type&&(e+=1)}),a.changeTimes=e,p.forEach(function(t,e){a.id===t&&(a.coOperation=!0)}),l.push(a)})}),l.forEach(function(t){e.push(t)}),s&&(s.finishPullUp(),s.refresh()),n.$initScroll(s,i,function(s){a.page+=1,n.ajax(t,a,e,s,i,r)})}else switch(r){case 1:n.showLoadingWrap1=!0,n.showLoadingImg1=!1;break;case 2:n.showLoadingWrap2=!0,n.showLoadingImg2=!1;break;default:break}}).catch(function(t){switch(r){case 1:n.showLoadingWrap1=!0,n.showLoadingImg1=!1;break;case 2:n.showLoadingWrap2=!0,n.showLoadingImg2=!1;break;default:break}})},loadData:function(t,a,e,s,i){console.log(t,a,e,s,i);var r={point_state:void 0,signerID:void 0,point_approverID:t,point_autoApprove:1},n="http://rest.apizza.net/mock/21c5cf3ed4022de252a80d8e8366c6f7/getListWithAddPointStatus";if(0===a)if(r.point_approverID=void 0,"审批中"===e){r.point_state=[1],this.showLoadingWrap1=!0,this.showLoadingImg1=!0;var o=[];o.push(r);var d={page:s,pageAmount:i,queryTaskList:JSON.stringify(o)};this.ajax(n,d,this.list1,this.scroll1,this.$refs.wrapper1_1,1)}else if("已审批"===e){r.point_state=[2,3,4],this.showLoadingWrap2=!0,this.showLoadingImg2=!0;var p=[];p.push(r);var l={page:s,pageAmount:i,queryTaskList:JSON.stringify(p)};this.ajax(n,l,this.list2,this.scroll2,this.$refs.wrapper1_2,2)}if("审批中"===e){r.point_state=[1],this.showLoadingWrap1=!0,this.showLoadingImg1=!0;var c=[];c.push(r);var g={page:s,pageAmount:i,queryTaskList:JSON.stringify(c)};this.ajax(n,g,this.list1,this.scroll1,this.$refs.wrapper1_1,1)}else if("已审批"===e){r.point_state=[2,3,4],this.showLoadingWrap2=!0,this.showLoadingImg2=!0;var h=[];h.push(r);var u={page:s,pageAmount:i,queryTaskList:JSON.stringify(h)};this.ajax(n,u,this.list2,this.scroll2,this.$refs.wrapper1_2,2)}},getLifeType:function(t){var a="";switch(t){case 1:a="新增";break;case 2:a="变更";break;case 3:a="完结";break;case 4:a="废止";break;case 5:a="反馈";break;case 6:a="传阅";break;default:a="";break}return a},judgeTarget:function(t){var a,e=t.lifePointList.length,s=t.lifePointList[t.lifePointList.length-1].state;if(2===s||3===s.state)a=s;else for(var i=0;i<e;i++)if(2!==t.lifePointList[i].state){a=t.lifePointList[i].state;break}return a}}},u=h,w=(e("b577"),e("2877")),m=Object(w["a"])(u,s,i,!1,null,"d875440c",null);a["default"]=m.exports},b577:function(t,a,e){"use strict";var s=e("dab4"),i=e.n(s);i.a},dab4:function(t,a,e){}}]);